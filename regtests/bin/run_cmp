#!/bin/sh
#
# Compare data in two work directories for a test
# Usage: run_cmp <test_name> <wrkdir1> <wrkdir2>
#
if [ ! $# = 3 ]
then
  echo "Usage: run_cmp <test_name> <wrkdir1> <wrkdir2>"
  exit 1
fi
tstdir=$1
wrkdir1=$2
wrkdir2=$3
if [ ! -d $tstdir ]
then
  echo "$tstdir not found"
  exit 1
fi
basedir="`pwd`"

cd $tstdir
if [ ! -d $wrkdir1 ]
then
  echo "$wrkdir1 not found"
  exit 1
fi
if [ ! -d $wrkdir2 ]
then
  echo "$wrkdir2 not found"
  exit 1
fi
cd $wrkdir1
files="`ls 2>/dev/null`"
cd ..


for f in $files; do
  case "$f" in
    log.*)
      continue
      ;;
    mod_def.* | out_grd.* | out_pnt.*)
      continue
      ;;
    ww3_grid*.out)
      continue
      ;;
    ww3_shel.out | ww3_multi.out)
      continue
      ;;
    *)
      f1=$wrkdir1/$f
      f2=$wrkdir2/$f
      ;;
  esac
  cmp="`cmp -s $f1 $f2 2>/dev/null`"
  case "$?" in
  0) echo "FILES SAME:    $f1 and $f2";;
  1) echo "FILES DIFFER:  $f1 and $f2" ;;
  *) echo "DIFF ERROR:    $f1 and $f2" ;;
  esac

done

